# ODPバリデーション・チェックリスト（Googleスライド互換版）> 目的：ODP（.odp）が Googleスライドで崩れずに **想定枚数・想定順** で表示されることを確認する。---## 1) パッケージ / ZIP 構造* [ ] `mimetype` が ZIP の **先頭** かつ **非圧縮（STORED）** で入っている（内容: `application/vnd.oasis.opendocument.presentation`）* [ ] `META-INF/manifest.xml` に **全ファイル**（`content.xml` / `styles.xml` / `meta.xml` / `settings.xml` / `Pictures/*`）が **正しい media-type** で列挙* [ ] **孤児リソースなし**（manifest にあるのに実体がない／実体があるのに manifest にない、がゼロ）## 2) XML / 名前空間・基本構造* [ ] `content.xml` ルートが `office:document-content`、子に `office:body > office:presentation`* [ ] すべての接頭辞（`office` / `draw` / `presentation` / `text` / `xlink` / `svg`）が **宣言済み*** [ ] `xlink:href`、`svg:x|y|width|height` 等の **名前空間付き属性**が正しく付与* [ ] XML が **well-formed**（未閉タグ・重複ID・無効文字なし、`<?xml ... encoding="UTF-8"?>`）## 3) スタイル / レイアウト* [ ] `styles.xml` に **16:9の `style:page-layout`**（例: 28cm × 15.75cm）が定義* [ ] `style:master-page` が上記 `page-layout` を参照（`style:page-layout-name="pm1"` 等）* [ ] 各スライド（`draw:page`）が **既存のマスターページ名**（例: `Default`）を参照* [ ] 使用している **オートスタイル名が未定義参照になっていない**## 4) スライド（ページ）構成* [ ] `draw:page` の枚数が **想定どおり**（今回の例: 12枚）* [ ] **出現順＝表示順** を満たす（Googleスライドは `draw:page` の並び順で表示）* [ ] テキストと図表の **インタリーブ順** が仕様どおり（例: 図表が後方に固まらない）* [ ] **空スライドなし**（各ページに最低限の `draw:text-box > text:p` などが存在）## 5) 画像（図表）の埋め込み* [ ] 構造が **`draw:frame > draw:image`**（直置きの `draw:image` は避ける）* [ ] `xlink:href` は **相対パス**で `Pictures/xxx.png` を指す* [ ] `svg:x` / `svg:y` / `svg:width` / `svg:height` は **単位付き（cm 推奨）**、スライド内に収まる* [ ] 実ファイルが `Pictures/` に存在し、**ファイル名（大小文字含む）一致*** [ ] 各図表の **キャプション枠**（`draw:text-box > text:p`）があり、**適切な説明文**（ファイル名そのままを避ける）## 6) 互換性（Googleスライド向け）* [ ] SMILアニメーション・インタラクション（`presentation:animations` / `presentation:event-listener`）は **未使用または最小限*** [ ] 複雑な塗り・透過・グラデーションは **PNG などのラスター画像**にしておく* [ ] **一般的フォント**（Noto / Arial 等）を使用し、特殊フォント名を避ける（置換での崩れ防止）* [ ] （任意）`Thumbnails/thumbnail.png` を用意してプレビューの安定性を向上## 7) メタ / 設定* [ ] `meta.xml` に `dc:title` / `dc:creator` / `meta:creation-date` などの基本メタがある* [ ] `settings.xml` は最小構成で壊れがない（アプリ固有設定は控えめ）## 8) 整合性 / リンク* [ ] すべての `xlink:href` が **解決可能**（相対リンク切れなし）* [ ] manifest と実体ファイルの **相互整合**（両者の齟齬なし）## 9) ファイルサイズ / 品質* [ ] 画像は **適切に圧縮・リサイズ**（過剰解像度で不安定化させない）* [ ] パッケージ全体が **極端に大型**になっていない（読み込みエラー回避）## 10) 迅速チェック（任意・自動化）* [ ] `lxml` などで `content.xml` / `styles.xml` / `manifest.xml` をパース（例外なし）* [ ] `draw:page` を列挙して **枚数・順序** を機械チェック* [ ] すべての `xlink:href` が `Pictures/` 内に **実在**するかファイルシステム照合* [ ] 使用している名前空間接頭辞が **すべて nsmap で宣言済み** かの検査---### トラブル時の代表例と対処* 図表が後ろに固まる → `content.xml` の `draw:page` **並び順** を修正* 一部スライドが表示されない → **未定義のマスターページ／オートスタイル参照**がないか確認* 画像が表示されない → `draw:frame > draw:image` 構造／`xlink:href` の相対パス／`Pictures/` 実体の有無を確認* レイアウトが崩れる → フォントを一般的なものへ／ベクタ効果をPNGへ置換